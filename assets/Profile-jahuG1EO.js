import{d as I,r as j,y as S,j as e,x as w,C as v,I as _,i as b,z as E,m as F}from"./index-DD8JO9LC.js";import{C as k}from"./CustomSelect-CA4NESJJ.js";import{U as C,P as R}from"./UserPreview-B_doIg9o.js";import{b as D}from"./index-DMQHx9uh.js";const U="_backdrop_12qxw_1",q="_modal_12qxw_21",N={backdrop:U,modal:q},P=({onClose:a,children:n,lockScroll:l=!0})=>(I(l),j.useEffect(()=>{const r=s=>{s.key==="Escape"&&a()};return document.addEventListener("keydown",r),()=>{document.removeEventListener("keydown",r)}},[a]),S.createPortal(e.jsx("div",{className:N.backdrop,onClick:a,children:e.jsx("div",{className:N.modal,onClick:r=>r.stopPropagation(),children:n})}),document.getElementById("portal-root"))),z="_avatarUploader_14ef7_1",B="_dragging_14ef7_15",W="_previewWrapper_14ef7_29",A="_preview_14ef7_29",L="_placeholder_14ef7_85",$="_fileInput_14ef7_95",x={avatarUploader:z,dragging:B,previewWrapper:W,preview:A,placeholder:L,fileInput:$},M=1024*1024*2,O=({value:a,onChange:n})=>{const l=j.useRef(null),[r,s]=j.useState(!1),{showSnackbar:m}=w(),i=()=>{l.current.click()},c=d=>{if(!d)return;if(d.size>M){m("Файл слишком большой (максимум 2MB)","error");return}const u=new FileReader;u.onloadend=()=>{n(u.result)},u.readAsDataURL(d)},h=d=>{c(d.target.files[0])},y=d=>{d.preventDefault(),s(!1);const u=d.dataTransfer?.files?.[0];c(u)};return e.jsx("div",{className:`${x.avatarUploader} ${r?x.dragging:""}`,onDragOver:d=>{d.preventDefault(),s(!0)},onDragLeave:()=>s(!1),onDrop:y,children:e.jsxs("div",{className:x.previewWrapper,children:[e.jsx("div",{className:x.preview,onClick:i,children:a?e.jsx("img",{src:a,alt:"Фото профиля"}):e.jsx("span",{className:x.placeholder,children:"+"})}),a&&e.jsx(v,{variant:"minimal","aria-label":"Удалить",onClick:()=>n(""),children:"X"}),e.jsx("input",{type:"file",accept:"image/*",ref:l,onChange:h,className:x.fileInput})]})})},T="_form_7zd6l_1",X="_title_7zd6l_13",Z="_topRow_7zd6l_25",G="_photoSection_7zd6l_39",K="_fieldsSection_7zd6l_55",V="_fieldItem_7zd6l_69",H="_editProfileActions_7zd6l_81",o={form:T,title:X,topRow:Z,photoSection:G,fieldsSection:K,fieldItem:V,editProfileActions:H},J=[{value:"male",label:"Мужской"},{value:"female",label:"Женский"},{value:"other",label:"Другое"}],Q=({user:a,onClose:n})=>{const[l,r]=j.useState({name:a.name||"",surname:a.surname||"",patronymic:a.patronymic||"",birthdate:a.birthdate||"",gender:a.gender||"",email:a.email||"",photo:a.photo||""}),s=i=>c=>{r(h=>({...h,[i]:c}))},m=i=>{i.preventDefault();const c=b();if(!c){console.warn("Не найден текущий пользователь");return}E(c,l),n()};return e.jsxs("form",{onSubmit:m,className:o.form,children:[e.jsx("h2",{className:o.title,children:"Редактирование профиля"}),e.jsxs("div",{className:o.topRow,children:[e.jsx("div",{className:o.photoSection,children:e.jsx(O,{id:"photo",value:l.photo,onChange:s("photo")})}),e.jsxs("div",{className:o.fieldsSection,children:[e.jsxs("div",{className:o.fieldItem,children:[e.jsx("label",{htmlFor:"username",children:"Имя"}),e.jsx(_,{id:"username",autoFocus:!0,value:l.name,onChange:s("name"),placeholder:"Имя *",required:!0})]}),e.jsxs("div",{className:o.fieldItem,children:[e.jsx("label",{htmlFor:"surname",children:"Фамилия"}),e.jsx(_,{id:"surname",value:l.surname,onChange:s("surname"),placeholder:"Фамилия"})]}),e.jsxs("div",{className:o.fieldItem,children:[e.jsx("label",{htmlFor:"patronymic",children:"Отчество"}),e.jsx(_,{id:"patronymic",value:l.patronymic,onChange:s("patronymic"),placeholder:"Отчество"})]})]})]}),e.jsxs("div",{className:o.fieldsSection,children:[e.jsxs("div",{className:o.fieldItem,children:[e.jsx("label",{htmlFor:"birthdate",children:"Дата рождения"}),e.jsx(_,{id:"birthdate",type:"date",value:l.birthdate,onChange:s("birthdate"),placeholder:"Дата рождения"})]}),e.jsxs("div",{className:o.fieldItem,children:[e.jsx("label",{htmlFor:"gender",children:"Пол"}),e.jsx(k,{id:"gender",options:J,value:l.gender,onChange:i=>s("gender")(i.target.value),placeholder:"Пол"})]}),e.jsxs("div",{className:o.fieldItem,children:[e.jsx("label",{htmlFor:"email",children:"Email"}),e.jsx(_,{id:"email",type:"email",value:l.email,onChange:s("email"),placeholder:"Email"})]})]}),e.jsxs("div",{className:o.editProfileActions,children:[e.jsx(v,{type:"submit",variant:"primary",children:"Сохранить"}),e.jsx(v,{onClick:n,variant:"outline",children:"Отмена"})]})]})},Y="_emptyField_slq2t_1",ee="_icon_slq2t_15",se="_box_slq2t_23",g={emptyField:Y,icon:ee,box:se},p=()=>e.jsxs("span",{className:g.emptyField,title:"Поле не заполнено",children:[e.jsx(D,{className:g.icon}),e.jsx("span",{className:g.box})]}),ae="_card_qkn0j_1",le="_header_qkn0j_21",te="_grid_qkn0j_33",ne="_label_qkn0j_47",re="_value_qkn0j_59",t={card:ae,header:le,grid:te,label:ne,value:re},ie=({user:a})=>{if(!a)return null;const{name:n,surname:l,patronymic:r,birthdate:s,gender:m,email:i,photo:c,id:h}=a;return e.jsxs("div",{className:t.card,children:[e.jsx("div",{className:t.header,children:e.jsx(C,{photo:c,name:n,size:R.LARGE})}),e.jsxs("div",{className:t.grid,children:[e.jsx("span",{className:t.label,children:"Имя:"}),e.jsx("span",{className:t.value,children:n||e.jsx(p,{})}),e.jsx("span",{className:t.label,children:"Фамилия:"}),e.jsx("span",{className:t.value,children:l||e.jsx(p,{})}),e.jsx("span",{className:t.label,children:"Отчество:"}),e.jsx("span",{className:t.value,children:r||e.jsx(p,{})}),e.jsx("span",{className:t.label,children:"Дата рождения:"}),e.jsx("span",{className:t.value,children:s||e.jsx(p,{})}),e.jsx("span",{className:t.label,children:"Пол:"}),e.jsx("span",{className:t.value,children:m==="male"?"Мужской":m==="female"?"Женский":e.jsx(p,{})}),e.jsx("span",{className:t.label,children:"Email:"}),e.jsx("span",{className:t.value,children:i||e.jsx(p,{})}),e.jsx("span",{className:t.label,children:"ID:"}),e.jsx("span",{className:t.value,children:h?e.jsx("code",{children:h}):e.jsx(p,{})})]})]})},oe="_profileSection_pud6x_1",ce="_headerRow_pud6x_25",de="_empty_pud6x_95",me="_editButtonWrapper_pud6x_107",f={profileSection:oe,headerRow:ce,empty:de,editButtonWrapper:me},_e=()=>{const[a,n]=j.useState(!1),l=F(),r=b(),s=l.find(c=>c.id===r);if(!s)return e.jsx("div",{className:f.empty,children:"Пользователь не найден"});const m=()=>n(!0),i=()=>n(!1);return e.jsxs(e.Fragment,{children:[a&&e.jsx(P,{onClose:i,children:e.jsx(Q,{user:s,onClose:i})}),e.jsxs("section",{className:f.profileSection,children:[e.jsxs("div",{className:f.headerRow,children:[e.jsx("h1",{className:"pageTitle",children:"Профиль"}),e.jsx("div",{className:f.editButtonWrapper,children:e.jsx(v,{variant:"outline",fullWidth:!0,onClick:m,children:"Редактировать"})})]}),s&&e.jsx(ie,{user:s})]})]})};export{_e as default};
